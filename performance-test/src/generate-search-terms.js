/*
  Uses the suggestion API to get a list of suggestion results.
  Useful for generating multi term search queries for load testing.
  Edit the configurable variables below then copy/paste this into
  the chrome dev tools console to run it. It will output to console.
*/

(function(args){
  /*
    SuggestionFetcher fetches results from suggestion API   
  */
  class SuggestionFetcher {
    constructor(api, index_name, suggestion_terms) {
      this.api = api;
      this.index_name = index_name;
      this.suggestion_terms = suggestion_terms;
      this.suggestion_results = [];
      this.baseurl = this.api.base_url + "/" + this.api.api_path
                  + "?api_key=" + this.api.api_key
                  + "&size=" + this.api.suggestion_count;
    }
    getSuggestions() {
      for (var i=0; i<this.suggestion_terms.length; i++){
        var url = this.baseurl + "&q=" + this.suggestion_terms[i];
        var data = this.getURL(url);
        this.extractSuggestions(data);
      }   
    }
    extractSuggestions(data){
      for (var i=0; i<data.length; i++){          
        this.suggestion_results.push(data[i]);
      }  
    }
    getURL(url) {   
      var xhr = new XMLHttpRequest();
      xhr.open('GET', url, false);  //false means syncronous
      xhr.send(null);   
      if (xhr.status === 200) {
        return JSON.parse(xhr.responseText);
      } else {
        return {};
      }     
    }
  }

  var do_output = function(sf){
    console.log("Found " + sf.suggestion_results.length + " results for index " + sf.index_name);
    console.log(sf.suggestion_results.join("\n"));
  }

  var main = function(args){     
    var sf = new SuggestionFetcher(args.api, args.api.index_name, args.suggestion_terms);
    sf.getSuggestions();
    do_output(sf);       
  }

  main(args);    
})({
  // Edit these arguments as needed. 
  api: {
    base_url: "https://api.sam.gov/prodlike",
    api_path: "sgs/v1/suggestions",
    api_key: "YOUR API KEY HERE",
    suggestion_count: 20, // max allowed is 100
    index_name: ""        // valid values are: cfda, opp, ex, ent, wd, fh, fpds or "" for all
  },
  // these terms are just from a subset of top 10k most frequent english words
  // there is nothing special about them
  suggestion_terms: [ "information",
                      "business",
                      "services",
                      "products",
                      "available",
                      "copyright",
                      "software",
                      "research",
                      "university",
                      "management",
                      "international",
                      "comments",
                      "development",
                      "education",
                      "national",
                      "internet",
                      "community",
                      "shipping",
                      "reserved",
                      "technology",
                      "security",
                      "american",
                      "computer",
                      "following",
                      "download",
                      "resources",
                      "pictures",
                      "personal",
                      "including",
                      "directory",
                      "location",
                      "government",
                      "children",
                      "students",
                      "shopping",
                      "previous",
                      "department",
                      "description",
                      "insurance",
                      "property",
                      "customer",
                      "december",
                      "different",
                      "training",
                      "categories",
                      "advanced",
                      "conditions",
                      "category",
                      "register",
                      "november",
                      "features",
                      "industry",
                      "provided",
                      "required",
                      "accessories",
                      "september",
                      "questions",
                      "application",
                      "articles",
                      "feedback",
                      "complete",
                      "financial",
                      "standard",
                      "equipment",
                      "programs",
                      "performance",
                      "language",
                      "experience",
                      "important",
                      "activities",
                      "additional",
                      "password",
                      "something",
                      "question",
                      "building",
                      "february",
                      "analysis",
                      "possible",
                      "professional",
                      "committee",
                      "problems",
                      "washington",
                      "interest",
                      "california",
                      "reference",
                      "companies",
                      "learning",
                      "delivery",
                      "computers",
                      "president",
                      "original",
                      "includes",
                      "australia",
                      "discussion",
                      "entertainment",
                      "agreement",
                      "messages",
                      "marketing",
                      "association",
                      "provides",
                      "specific",
                      "collection",
                      "solutions",
                      "director",
                      "electronics",
                      "planning",
                      "database",
                      "official",
                      "technical",
                      "microsoft",
                      "conference",
                      "environment",
                      "district",
                      "calendar",
                      "statement",
                      "downloads",
                      "resource",
                      "applications",
                      "document",
                      "material",
                      "requirements",
                      "individual",
                      "together",
                      "function",
                      "economic",
                      "projects",
                      "subscribe",
                      "included",
                      "everything",
                      "production",
                      "commercial",
                      "advertising",
                      "received",
                      "treatment",
                      "newsletter",
                      "archives",
                      "knowledge",
                      "magazine",
                      "currently",
                      "construction",
                      "registered",
                      "protection",
                      "policies",
                      "position",
                      "listings",
                      "engineering",
                      "wireless",
                      "published",
                      "corporate",
                      "purchase",
                      "customers",
                      "response",
                      "practice",
                      "hardware",
                      "materials",
                      "designed",
                      "countries",
                      "discount",
                      "remember",
                      "standards",
                      "political",
                      "increase",
                      "advertise",
                      "environmental",
                      "availability",
                      "european",
                      "activity",
                      "although",
                      "employment",
                      "commission",
                      "contents",
                      "regional",
                      "supplies",
                      "administration",
                      "institute",
                      "exchange",
                      "sponsored",
                      "electronic",
                      "continue",
                      "benefits",
                      "anything",
                      "condition",
                      "effective",
                      "organization",
                      "selection",
                      "mortgage",
                      "corporation",
                      "solution",
                      "addition",
                      "executive",
                      "necessary",
                      "according",
                      "clothing",
                      "particular",
                      "homepage",
                      "military",
                      "decision",
                      "facilities",
                      "opportunities",
                      "division",
                      "appropriate",
                      "actually",
                      "statistics",
                      "investment",
                      "saturday",
                      "christmas",
                      "starting",
                      "registration",
                      "thursday",
                      "consumer",
                      "furniture",
                      "wednesday",
                      "structure",
                      "contract",
                      "releases",
                      "virginia",
                      "multiple",
                      "distribution",
                      "industrial",
                      "potential",
                      "featured",
                      "responsible",
                      "communications",
                      "associated",
                      "foundation",
                      "friendly",
                      "schedule",
                      "documents",
                      "communication",
                      "everyone",
                      "independent",
                      "approach",
                      "physical",
                      "operating",
                      "medicine",
                      "developed",
                      "telephone",
                      "population",
                      "navigation",
                      "operations",
                      "therefore",
                      "evidence",
                      "christian",
                      "favorite",
                      "understand",
                      "recently",
                      "probably",
                      "publications",
                      "worldwide",
                      "connection",
                      "publisher",
                      "networks",
                      "transfer",
                      "introduction",
                      "carolina",
                      "properties",
                      "hospital",
                      "overview",
                      "accommodation",
                      "excellent",
                      "opportunity",
                      "distance",
                      "assessment",
                      "involved",
                      "especially",
                      "interface",
                      "partners",
                      "operation",
                      "existing",
                      "selected",
                      "patients",
                      "restaurants",
                      "beautiful",
                      "locations",
                      "significant",
                      "technologies",
                      "directly",
                      "manufacturer",
                      "providing",
                      "searches",
                      "authority",
                      "considered",
                      "programme",
                      "strategy",
                      "teaching",
                      "canadian",
                      "enterprise",
                      "educational",
                      "positive",
                      "football",
                      "abstract",
                      "employees",
                      "alternative",
                      "processing",
                      "responsibility",
                      "resolution",
                      "publication",
                      "relations",
                      "contains",
                      "photography",
                      "republic",
                      "components",
                      "vacation",
                      "academic",
                      "assistance",
                      "completed",
                      "graphics",
                      "expected",
                      "mountain",
                      "organizations",
                      "consider",
                      "northern",
                      "proposed",
                      "otherwise",
                      "reported",
                      "transportation",
                      "politics",
                      "disclaimer",
                      "membership",
                      "modified",
                      "released",
                      "internal",
                      "recommended",
                      "detailed",
                      "japanese",
                      "approved",
                      "background",
                      "character",
                      "maintenance",
                      "functions",
                      "trademarks",
                      "phentermine",
                      "southern",
                      "yourself",
                      "pressure",
                      "submitted",
                      "keywords",
                      "television",
                      "interested",
                      "purposes",
                      "throughout",
                      "established",
                      "programming",
                      "external",
                      "regarding",
                      "instructions",
                      "teachers",
                      "subjects",
                      "increased",
                      "understanding",
                      "beginning",
                      "associates",
                      "capacity",
                      "requires",
                      "electric",
                      "instruments",
                      "businesses",
                      "specified",
                      "restaurant",
                      "procedures",
                      "relationship",
                      "traditional",
                      "creative",
                      "progress",
                      "sometimes",
                      "families",
                      "themselves",
                      "transport",
                      "interesting",
                      "evaluation",
                      "accepted",
                      "implementation",
                      "galleries",
                      "references",
                      "presented",
                      "agencies",
                      "literature",
                      "respective",
                      "michigan",
                      "columbia",
                      "critical",
                      "definition",
                      "secretary",
                      "networking",
                      "australian",
                      "employee",
                      "magazines",
                      "packages",
                      "francisco",
                      "individuals",
                      "colorado",
                      "relevant",
                      "guidelines",
                      "installation",
                      "described",
                      "attention",
                      "difference",
                      "illinois",
                      "regulations"]
});
